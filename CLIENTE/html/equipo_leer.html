<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Agrupar en Equipos</title>
</head>
<body>
    <input type="file" id="file-input" />
    <h3>Contenido sin duplicados y agrupado por género:</h3>
    <pre id="contenido-filtrado"></pre>

    <script>
        document.getElementById('file-input').addEventListener('change', async (e) => {
            const archivo = e.target.files[0];
            if (!archivo) return;

            const contenido = await leerArchivo(archivo);
            console.log("Contenido original:", contenido);

            const contenidoFiltrado = filtrarDuplicados(contenido);
            console.log("Contenido sin duplicados:", contenidoFiltrado);

            const agrupadoPorGenero = agruparPorGenero(contenidoFiltrado);
            console.log("Contenido agrupado por género:", agrupadoPorGenero);

            document.getElementById('contenido-filtrado').textContent = agrupadoPorGenero;
        }, false);

        async function leerArchivo(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = (e) => reject(e);
                reader.readAsText(file);
            });
        }

        function filtrarDuplicados(contenido) {
            const lineas = contenido.split('\n');
            const repartoSet = new Set();

            lineas.forEach(linea => {
                const [nombre, genero, apellido, puesto, equipo] = linea.split(';');
                if (nombre && genero && apellido && puesto && equipo) {
                    repartoSet.add(`${nombre};${genero};${apellido};${puesto};${equipo}`);
                }
            });

            return Array.from(repartoSet);
        }

        function agruparPorGenero(repartoSet) {
            const gruposGenero = {
                Masculino: [],
                Femenino: []
            };

            repartoSet.forEach(contacto => {
                const [nombre, genero, apellido, puesto, equipo] = contacto.split(';');
                if (genero === "M") {
                    gruposGenero.Masculino.push(`${nombre} ${apellido} - ${puesto} (${equipo})`);
                } else if (genero === "F") {
                    gruposGenero.Femenino.push(`${nombre} ${apellido} - ${puesto} (${equipo})`);
                }
            });

            let resultado = '';
            for (const genero in gruposGenero) {
                resultado += `\n${genero}:\n`;
                resultado += gruposGenero[genero].join('\n') + '\n';
            }
            return resultado;
        }
    </script>
</body>
</html>
